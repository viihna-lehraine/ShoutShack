// File: server/src/common/services/errorHandler.ts
import { AppError } from '../../types/index.js';
import { logger } from './logger.js';
export const errorHandler = (app) => {
    app.setErrorHandler((error, _req, reply) => {
        const statusCode = error instanceof AppError ? error.statusCode : 500;
        logger.error(`[ERROR] ${error.message}`, { stack: error.stack });
        reply.status(statusCode).send({
            success: false,
            message: error.message || 'Internal Server Error'
        });
    });
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXJyb3JIYW5kbGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvbW1vbi9zZXJ2aWNlcy9lcnJvckhhbmRsZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsbURBQW1EO0FBRW5ELE9BQU8sRUFBRSxRQUFRLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUVoRCxPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBRXJDLE1BQU0sQ0FBQyxNQUFNLFlBQVksR0FBRyxDQUFDLEdBQW9CLEVBQUUsRUFBRTtJQUNwRCxHQUFHLENBQUMsZUFBZSxDQUFDLENBQUMsS0FBSyxFQUFFLElBQW9CLEVBQUUsS0FBbUIsRUFBRSxFQUFFO1FBQ3hFLE1BQU0sVUFBVSxHQUFHLEtBQUssWUFBWSxRQUFRLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztRQUV0RSxNQUFNLENBQUMsS0FBSyxDQUFDLFdBQVcsS0FBSyxDQUFDLE9BQU8sRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBRWpFLEtBQUssQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDO1lBQzdCLE9BQU8sRUFBRSxLQUFLO1lBQ2QsT0FBTyxFQUFFLEtBQUssQ0FBQyxPQUFPLElBQUksdUJBQXVCO1NBQ2pELENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gRmlsZTogc2VydmVyL3NyYy9jb21tb24vc2VydmljZXMvZXJyb3JIYW5kbGVyLnRzXG5cbmltcG9ydCB7IEFwcEVycm9yIH0gZnJvbSAnLi4vLi4vdHlwZXMvaW5kZXguanMnO1xuaW1wb3J0IHsgRmFzdGlmeUluc3RhbmNlLCBGYXN0aWZ5UmVwbHksIEZhc3RpZnlSZXF1ZXN0IH0gZnJvbSAnZmFzdGlmeSc7XG5pbXBvcnQgeyBsb2dnZXIgfSBmcm9tICcuL2xvZ2dlci5qcyc7XG5cbmV4cG9ydCBjb25zdCBlcnJvckhhbmRsZXIgPSAoYXBwOiBGYXN0aWZ5SW5zdGFuY2UpID0+IHtcblx0YXBwLnNldEVycm9ySGFuZGxlcigoZXJyb3IsIF9yZXE6IEZhc3RpZnlSZXF1ZXN0LCByZXBseTogRmFzdGlmeVJlcGx5KSA9PiB7XG5cdFx0Y29uc3Qgc3RhdHVzQ29kZSA9IGVycm9yIGluc3RhbmNlb2YgQXBwRXJyb3IgPyBlcnJvci5zdGF0dXNDb2RlIDogNTAwO1xuXG5cdFx0bG9nZ2VyLmVycm9yKGBbRVJST1JdICR7ZXJyb3IubWVzc2FnZX1gLCB7IHN0YWNrOiBlcnJvci5zdGFjayB9KTtcblxuXHRcdHJlcGx5LnN0YXR1cyhzdGF0dXNDb2RlKS5zZW5kKHtcblx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0bWVzc2FnZTogZXJyb3IubWVzc2FnZSB8fCAnSW50ZXJuYWwgU2VydmVyIEVycm9yJ1xuXHRcdH0pO1xuXHR9KTtcbn07XG4iXX0=