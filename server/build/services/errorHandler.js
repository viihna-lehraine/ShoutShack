// File: server/src/services/errorHandler.ts
import { AppError } from '../types/index.js';
export const registerGlobalErrorHandler = (app) => {
    app.setErrorHandler((error, _req, reply) => {
        const statusCode = error instanceof AppError ? error.statusCode : 500;
        console.error(`[ERROR] ${error.message}`, { stack: error.stack });
        reply.status(statusCode).send({
            success: false,
            error: error.name || 'InternalServerError',
            message: error.message || 'Something went wrong',
            statusCode
        });
    });
    console.log('Global error handler registered');
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXJyb3JIYW5kbGVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3NlcnZpY2VzL2Vycm9ySGFuZGxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSw0Q0FBNEM7QUFFNUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FBRzdDLE1BQU0sQ0FBQyxNQUFNLDBCQUEwQixHQUFHLENBQUMsR0FBb0IsRUFBRSxFQUFFO0lBQ2xFLEdBQUcsQ0FBQyxlQUFlLENBQUMsQ0FBQyxLQUFtQixFQUFFLElBQW9CLEVBQUUsS0FBbUIsRUFBRSxFQUFFO1FBQ3RGLE1BQU0sVUFBVSxHQUFHLEtBQUssWUFBWSxRQUFRLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQztRQUV0RSxPQUFPLENBQUMsS0FBSyxDQUFDLFdBQVcsS0FBSyxDQUFDLE9BQU8sRUFBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDO1FBRWxFLEtBQUssQ0FBQyxNQUFNLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDO1lBQzdCLE9BQU8sRUFBRSxLQUFLO1lBQ2QsS0FBSyxFQUFFLEtBQUssQ0FBQyxJQUFJLElBQUkscUJBQXFCO1lBQzFDLE9BQU8sRUFBRSxLQUFLLENBQUMsT0FBTyxJQUFJLHNCQUFzQjtZQUNoRCxVQUFVO1NBQ1YsQ0FBQyxDQUFDO0lBQ0osQ0FBQyxDQUFDLENBQUM7SUFFSCxPQUFPLENBQUMsR0FBRyxDQUFDLGlDQUFpQyxDQUFDLENBQUM7QUFDaEQsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gRmlsZTogc2VydmVyL3NyYy9zZXJ2aWNlcy9lcnJvckhhbmRsZXIudHNcblxuaW1wb3J0IHsgQXBwRXJyb3IgfSBmcm9tICcuLi90eXBlcy9pbmRleC5qcyc7XG5pbXBvcnQgeyBGYXN0aWZ5RXJyb3IsIEZhc3RpZnlJbnN0YW5jZSwgRmFzdGlmeVJlcGx5LCBGYXN0aWZ5UmVxdWVzdCB9IGZyb20gJ2Zhc3RpZnknO1xuXG5leHBvcnQgY29uc3QgcmVnaXN0ZXJHbG9iYWxFcnJvckhhbmRsZXIgPSAoYXBwOiBGYXN0aWZ5SW5zdGFuY2UpID0+IHtcblx0YXBwLnNldEVycm9ySGFuZGxlcigoZXJyb3I6IEZhc3RpZnlFcnJvciwgX3JlcTogRmFzdGlmeVJlcXVlc3QsIHJlcGx5OiBGYXN0aWZ5UmVwbHkpID0+IHtcblx0XHRjb25zdCBzdGF0dXNDb2RlID0gZXJyb3IgaW5zdGFuY2VvZiBBcHBFcnJvciA/IGVycm9yLnN0YXR1c0NvZGUgOiA1MDA7XG5cblx0XHRjb25zb2xlLmVycm9yKGBbRVJST1JdICR7ZXJyb3IubWVzc2FnZX1gLCB7IHN0YWNrOiBlcnJvci5zdGFjayB9KTtcblxuXHRcdHJlcGx5LnN0YXR1cyhzdGF0dXNDb2RlKS5zZW5kKHtcblx0XHRcdHN1Y2Nlc3M6IGZhbHNlLFxuXHRcdFx0ZXJyb3I6IGVycm9yLm5hbWUgfHwgJ0ludGVybmFsU2VydmVyRXJyb3InLFxuXHRcdFx0bWVzc2FnZTogZXJyb3IubWVzc2FnZSB8fCAnU29tZXRoaW5nIHdlbnQgd3JvbmcnLFxuXHRcdFx0c3RhdHVzQ29kZVxuXHRcdH0pO1xuXHR9KTtcblxuXHRjb25zb2xlLmxvZygnR2xvYmFsIGVycm9yIGhhbmRsZXIgcmVnaXN0ZXJlZCcpO1xufTtcbiJdfQ==